services:
  drupal-db:
    environment:
      POSTGRES_USER: association
      POSTGRES_PASSWORD: association_pass
      POSTGRES_DB: association_db

  payments-db:
    environment:
      POSTGRES_USER: payments
      POSTGRES_PASSWORD: payments_pass
      POSTGRES_DB: payments_db

  drupal-nginx:
    ports:
      - "8080:80"
    labels:
      traefik.enable: "false"

  payment-api:
    environment:
      NODE_ENV: development
      PORT: 3000
      PAYMENT_DB_HOST: payments-db
      PAYMENT_DB_PORT: 5432
      PAYMENT_DB_USER: payments
      PAYMENT_DB_PASSWORD: payments_pass
      PAYMENT_DB_NAME: payments_db
      BASE_URL: http://localhost:3000
      DRUPAL_WEBHOOK_URL: http://drupal-nginx/association/webhook
      DRUPAL_WEBHOOK_TOKEN: dev_token
    ports:
      - "3000:3000"
    labels:
      traefik.enable: "false"
